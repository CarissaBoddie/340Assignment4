const readlineSync = require('readline-sync');
const fs = require('fs');

const FILE_PATH = 'data.json';

// Function to read data from the JSON file
function readData() {
    try {
        const data = fs.readFileSync(FILE_PATH, 'utf8');
        return JSON.parse(data);
    } catch (error) {
        return [];
    }
}

// Function to write data to the JSON file
function writeData(data) {
    fs.writeFileSync(FILE_PATH, JSON.stringify(data, null, 2));
}

// Function to prompt user for data creation
function createData() {
    const newData = readlineSync.question('Enter new data: ');
    const data = readData();
    data.push(newData);
    writeData(data);
    console.log('Data created successfully.');
}

// Function to display previously created data
function displayData() {
    const data = readData();
    if (data.length === 0) {
        console.log('No data found.');
    } else {
        console.log('Previous data:');
        data.forEach((item, index) => {
            console.log(`${index + 1}. ${item}`);
        });
    }
}

// Function to update existing data
function updateData() {
    const data = readData();
    if (data.length === 0) {
        console.log('No data to update.');
        return;
    }

    displayData();

    const index = readlineSync.questionInt('Enter the index of the data you want to update: ') - 1;
    if (index < 0 || index >= data.length) {
        console.log('Invalid index.');
        return;
    }

    const updatedData = readlineSync.question('Enter updated data: ');
    data[index] = updatedData;
    writeData(data);
    console.log('Data updated successfully.');
}

// Function to delete existing data
function deleteData() {
    const data = readData();
    if (data.length === 0) {
        console.log('No data to delete.');
        return;
    }

    displayData();

    const index = readlineSync.questionInt('Enter the index of the data you want to delete: ') - 1;
    if (index < 0 || index >= data.length) {
        console.log('Invalid index.');
        return;
    }

    data.splice(index, 1);
    writeData(data);
    console.log('Data deleted successfully.');
}

// Main function
function main() {
    while (true) {
        console.log('\n1. Create data');
        console.log('2. Read data');
        console.log('3. Update data');
        console.log('4. Delete data');
        console.log('5. Exit');

        const choice = readlineSync.questionInt('Enter your choice: ');

        switch (choice) {
            case 1:
                createData();
                break;
            case 2:
                displayData();
                break;
            case 3:
                updateData();
                break;
            case 4:
                deleteData();
                break;
            case 5:
                process.exit(0);
            default:
                console.log('Invalid choice. Please try again.');
        }
    }
}

main();